const searchInput=document.querySelector(".search-input"),locationButton=document.querySelector(".location-button"),currentWeatherDiv=document.querySelector(".current-weather"),hourlyWeatherDiv=document.querySelector(".hourly-weather .weather-list"),API_KEY="7169115372824792bbd54924241708",weatherCodes={clear:[1e3],clouds:[1003,1006,1009],mist:[1030,1135,1147],rain:[1063,1150,1153,1168,1171,1180,1183,1198,1201,1240,1243,1246,1273,1276],moderate_heavy_rain:[1186,1189,1192,1195,1243,1245],snow:[1066,1069,1072,1114,1117,1204,1207,1210,1213,1216,1219,1222,1225,1237,1249,1252,1255,1258,1261,1264,1279,1282],thunder:[1087,1279,1282],thunder_rain:[1273,1276]},displayHourlyForecast=e=>{let t=new Date().setMinutes(0,0,0),r=864e5*t,a=e.filter(({time:e})=>{let a=new Date(e).getTime();return a>=t&&a<=r});hourlyWeatherDiv.innerHTML=a.map(e=>{let t=Math.floor(e.temp_c),r=e.time.split(" ")[1].substring(0,5),a=Object.keys(weatherCodes).find(t=>weatherCodes[t].includes(e.condition.code));return`<li class="weather-item"><p class="time">${r}</p><img src="https://flacdb.netlify.app/img/weather-app-icons//${a}.svg" class="weather-icon"><p class="temperature">${t}\xb0</p></li>`}).join("")},getWeatherDetails=async e=>{window.innerWidth<=768&&searchInput.blur(),document.body.classList.remove("show-no-results");try{let t=await fetch(e),r=await t.json(),a=Math.floor(r.current.temp_c),s=r.current.condition.text,o=Object.keys(weatherCodes).find(e=>weatherCodes[e].includes(r.current.condition.code));currentWeatherDiv.querySelector(".weather-icon").src=`https://flacdb.netlify.app/img/weather-app-icons/${o}.svg`,currentWeatherDiv.querySelector(".temperature").innerHTML=`${a}<span>\xb0C</span>`,currentWeatherDiv.querySelector(".description").innerText=s;let _=[...r.forecast.forecastday[0].hour,...r.forecast.forecastday[1].hour];displayHourlyForecast(_),searchInput.value=r.location.name,console.log(r)}catch(n){document.body.classList.add("show-no-results"),console.error(n)}},setupWeatherRequest=e=>{let t=`https://api.weatherapi.com/v1/forecast.json?key=${API_KEY}&q=${e}&days=2`;getWeatherDetails(t)};searchInput.addEventListener("keyup",e=>{let t=searchInput.value.trim();"Enter"==e.key&&t&&setupWeatherRequest(t)}),locationButton.addEventListener("click",()=>{navigator.geolocation.getCurrentPosition(e=>{let{latitude:t,longitude:r}=e.coords,a=`https://api.weatherapi.com/v1/forecast.json?key=${API_KEY}&q=${cityName}&q=${t},${r}&days=2`;getWeatherDetails(a),console.log(e)},e=>{alert("Location access denied. Please enable permission to use this feature.")})}),setupWeatherRequest("lianyuan");